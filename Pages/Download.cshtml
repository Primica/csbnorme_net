@page
@model csbnorme_net.Pages.DownloadModel
@{
    ViewData["Title"] = "Télécharger - CSBNorm";
}

<div class="download-page">
    <!-- Hero -->
    <section class="download-hero">
        <div class="hero-content">
            <h1>Télécharger CSBNorm</h1>
            <p>Obtenez le binaire et installez-le en quelques minutes</p>
        </div>
    </section>

    <!-- Download Cards -->
    <section class="download-cards-section">
        <div class="download-container">
            <div class="download-cards">
                <div class="download-card">
                    <div class="download-icon">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                            <line x1="15" y1="3" x2="15" y2="21"></line>
                        </svg>
                    </div>
                    <h2>Windows</h2>
                    <p class="version">Version 1.0.0</p>
                    <a href="/downloads/csbnorm-windows-amd64.exe" class="btn-download" download>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Télécharger pour Windows
                    </a>
                    <p class="file-info">csbnorm-windows-amd64.exe • ~5 MB</p>
                </div>

                <div class="download-card">
                    <div class="download-icon">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                            <line x1="9" y1="9" x2="9.01" y2="9"></line>
                            <line x1="15" y1="9" x2="15.01" y2="9"></line>
                        </svg>
                    </div>
                    <h2>Linux</h2>
                    <p class="version">Version 1.0.0</p>
                    <div class="install-command">
                        <p class="command-label">Installation en une commande :</p>
                        <div class="command-box">
                            <code id="linux-install-cmd">curl -L http://localhost:5093/downloads/csbnorm-linux-amd64 -o csbnorm && chmod +x csbnorm && sudo ./csbnorm install</code>
                            <button class="copy-btn" onclick="copyToClipboard('linux-install-cmd')" title="Copier">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <p class="file-info">csbnorm-linux-amd64 • ~5 MB</p>
                </div>

                <div class="download-card disabled">
                    <div class="download-icon">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                            <path d="M2 17l10 5 10-5"></path>
                            <path d="M2 12l10 5 10-5"></path>
                        </svg>
                    </div>
                    <h2>macOS</h2>
                    <p class="version">Bientôt disponible</p>
                    <button class="btn-download" disabled>
                        Prochainement
                    </button>
                    <p class="file-info">Version en développement</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Installation Instructions -->
    <section class="install-instructions-section">
        <div class="install-container">
            <h2>Instructions d'installation</h2>
            
            <!-- Linux Installation -->
            <div class="platform-instructions">
                <h3 class="platform-title">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                    </svg>
                    Linux
                </h3>
                
                <div class="setup-option">
                    <h4><span class="option-number">Installation rapide</span> Via curl (Recommandé)</h4>
                    <p>Une seule commande pour télécharger et installer CSBNorm.</p>
                    <div class="code-example">
                        <pre><code># Télécharger et installer automatiquement
curl -L https://votre-domaine.com/downloads/csbnorm-linux-amd64 -o csbnorm
chmod +x csbnorm
sudo ./csbnorm install

# Vérifier l'installation
csbnorm --version</code></pre>
                    </div>
                    <p class="note">La commande <code>install</code> copie automatiquement le binaire dans <code>/usr/local/bin</code> et le rend accessible globalement.</p>
                </div>

                <div class="setup-option">
                    <h4><span class="option-number">Installation manuelle</span> Sans sudo</h4>
                    <p>Installer dans votre répertoire utilisateur.</p>
                    <div class="code-example">
                        <pre><code># Télécharger
curl -L https://votre-domaine.com/downloads/csbnorm-linux-amd64 -o csbnorm
chmod +x csbnorm

# Déplacer vers un dossier local
mkdir -p ~/.local/bin
mv csbnorm ~/.local/bin/

# Ajouter au PATH (ajouter à ~/.bashrc ou ~/.zshrc)
echo 'export PATH="$HOME/.local/bin:$PATH"' >> ~/.bashrc
source ~/.bashrc</code></pre>
                    </div>
                </div>

                <div class="setup-option">
                    <h4><span class="option-number">Utilisation locale</span> Sans installation</h4>
                    <p>Utiliser directement dans le dossier courant.</p>
                    <div class="code-example">
                        <pre><code># Télécharger
wget https://votre-domaine.com/downloads/csbnorm-linux-amd64 -O csbnorm
chmod +x csbnorm

# Utiliser
./csbnorm check mon-projet/</code></pre>
                    </div>
                </div>
            </div>

            <!-- Windows Installation -->
            <div class="platform-instructions">
                <h3 class="platform-title">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    </svg>
                    Windows
                </h3>
                
                <div class="setup-option">
                    <h4><span class="option-number">Installation rapide</span> Via PowerShell (Recommandé)</h4>
                    <p>Téléchargez le binaire, puis utilisez la commande d'auto-installation.</p>
                    <div class="code-example">
                        <pre><code># PowerShell (en tant qu'Administrateur)
# Télécharger le binaire
Invoke-WebRequest -Uri "http://localhost:5093/downloads/csbnorm-windows-amd64.exe" -OutFile "csbnorm.exe"

# Installer automatiquement dans le PATH
.\csbnorm.exe install

# Vérifier l'installation
csbnorm --version</code></pre>
                    </div>
                    <p class="note">La commande <code>install</code> copie automatiquement le binaire dans <code>C:\Program Files\CSBNorm</code> et l'ajoute au PATH système.</p>
                </div>

                <div class="setup-option">
                    <h4><span class="option-number">Installation manuelle</span> Sans droits admin</h4>
                    <p>Installer dans votre répertoire utilisateur.</p>
                    <div class="code-example">
                        <pre><code># PowerShell
# Créer un dossier local
New-Item -ItemType Directory -Path "$env:USERPROFILE\.local\bin" -Force

# Déplacer le binaire
Move-Item csbnorm-windows-amd64.exe "$env:USERPROFILE\.local\bin\csbnorm.exe"

# Ajouter au PATH utilisateur
$userPath = [Environment]::GetEnvironmentVariable("Path", "User")
$newPath = "$env:USERPROFILE\.local\bin;$userPath"
[Environment]::SetEnvironmentVariable("Path", $newPath, "User")

# Redémarrer PowerShell puis :
csbnorm --version</code></pre>
                    </div>
                </div>

                <div class="setup-option">
                    <h4><span class="option-number">Utilisation locale</span> Sans installation</h4>
                    <p>Utiliser directement dans le dossier courant sans modifier le PATH.</p>
                    <div class="code-example">
                        <pre><code># PowerShell
# Utiliser directement
.\csbnorm-windows-amd64.exe check mon-projet/

# Ou renommer pour simplifier
Rename-Item csbnorm-windows-amd64.exe csbnorm.exe
.\csbnorm.exe check mon-projet/</code></pre>
                    </div>
                </div>
            </div>

            <!-- Usage Examples -->
            <div class="usage-examples">
                <h2>Utilisation rapide</h2>
                <div class="code-example">
                    <pre><code># Vérifier un projet entier
csbnorm check ./mon-projet

# Vérifier un fichier spécifique
csbnorm check ./mon-projet/app/controllers/UserController.php

# Générer un rapport détaillé
csbnorm check ./mon-projet --report=html

# Lister toutes les règles
csbnorm rules

# Afficher l'aide
csbnorm --help</code></pre>
                </div>
            </div>

            <!-- Quick Links -->
            <div class="quick-links">
                <a href="/" class="link-card">
                    <h4>← Retour à l'accueil</h4>
                    <p>Découvrir CSBNorm</p>
                </a>
                <a href="/Rules" class="link-card">
                    <h4>Documentation des règles →</h4>
                    <p>Voir toutes les règles de la norminette</p>
                </a>
            </div>
        </div>
    </section>
</div>

<script>
function copyToClipboard(elementId) {
    const element = document.getElementById(elementId);
    const text = element.textContent;
    
    navigator.clipboard.writeText(text).then(() => {
        // Feedback visuel
        const button = event.target.closest('.copy-btn');
        const originalHTML = button.innerHTML;
        button.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>';
        button.classList.add('copied');
        
        setTimeout(() => {
            button.innerHTML = originalHTML;
            button.classList.remove('copied');
        }, 2000);
    }).catch(err => {
        console.error('Erreur lors de la copie:', err);
    });
}
</script>
